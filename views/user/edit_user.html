{% extends 'layout/application.html' %}
{% block content %}
<script type="text/javascript">
    navButtons = [
        "<button class=\"nvButton Green\" onmousedown=\"window.location='/'\" style=\"float: right;\">Finish</button>",
        "<button class=\"nvButton\" onmousedown='showEditUserDialog()' style=\"float: right;\">Edit User</button>"]
</script>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/keyboard.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/toastify.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/table.css') }}">
<script src="{{url_for('static', filename='javascript/paginate.min.js')}}"></script>
<script src="{{url_for('static', filename='javascript/keyboard.js')}}" defer></script>
<script src="{{url_for('static', filename='javascript/keyboard_init.js')}}" defer></script>

<h1>Edit User</h1>
<div style="width: 95%; margin-left:auto; margin-right:auto; height: 85%; overflow: auto; text-align:left;">
    <form id="editUserForm" method="post" action="/user/{{ user_id }}/edit">
        <!-- Tab 1: User Details -->
        <div class="tab">
            <h2>User Details</h2>
            <h3>Full Name</h3>
            <input type="text" placeholder="Full name" name="name" value="{{ user.name }}" required style="width: 90%; font-size: 18pt; border-radius: 5px; height: 7vh;">
            <h3>Username</h3>
            <input type="text" placeholder="Username" name="username" value="{{ user.username }}" required style="width: 90%; font-size: 18pt; border-radius: 5px; height: 7vh;">
        </div>

        <!-- Tab 2: User Role -->
        <div class="tab">
            <h2>User Role</h2>
            <ul>
                <li>
                    <input type="radio" id="clinicalOfficer" value="Clinical Officer" name="role" onchange="filterDesignations('doc')" {% if user.role == 'Clinical Officer' %}checked{% endif %}>
                    <label for="clinicalOfficer">Clinical Officer</label>
                    <div class="check"></div>
                </li>
                <li>
                    <input type="radio" id="doctor" value="Doctor" name="role" onchange="filterDesignations('doc')" {% if user.role == 'Doctor' %}checked{% endif %}>
                    <label for="doctor">Doctor</label>
                    <div class="check"></div>
                </li>
                <li>
                    <input type="radio" id="Nurse" value="Nurse" name="role" onchange="filterDesignations('doc')" {% if user.role == 'Nurse' %}checked{% endif %}>
                    <label for="nurse">Nurse</label>
                    <div class="check"></div>
                </li>
                <li>
                    <input type="radio" id="Student" value="Student" name="role" onchange="filterDesignations('doc')" {% if user.role == 'Student' %}checked{% endif %}>
                    <label for="student">Student</label>
                    <div class="check"></div>
                </li>
            </ul>
        </div>
        
        <!-- Tab 3 -->
        <div class="tab">
            <h2>User Designation</h2>
            <ul>
                <li>
                    <input type="radio" id="clinicalOfficer" value="Clinical Officer" name="designation" {% if user.designation == 'Clinical Officer' %}checked{% endif %}>
                    <label for="clinicalOfficer">Clinical Officer</label>
                    <div class="check"></div>
                </li>
                <li>
                    <input type="radio" id="consultant" value="Consultant" name="designation" {% if user.designation == 'Consultant' %}checked{% endif %}>
                    <label for="consultant">Consultant</label>
                    <div class="check"></div>
                </li>
           
            </ul>
        </div>
        
         <!-- Tab 4 -->
        <div class="tab">
            <h2>Allocation</h2>
            <ul>
                <li>
                    <input type="radio" id="shortStay" value="Short Stay" name="allocation" {% if user.allocation == 'Short Stay' %}checked{% endif %}>
                    <label for="shortStay">Short Stay</label>
                    <div class="check"></div>
                </li>
                <li>
                    <input type="radio" id="opd" value="OPD" name="allocation" {% if user.allocation == 'OPD' %}checked{% endif %}>
                    <label for="opd">OPD</label>
                    <div class="check"></div>
                </li>
                
            </ul>
        </div>

        <div style="border: 1px solid silver; margin-top: 1vh;">
            <table style="width:100%;">
                <tr>
                    <td>
                        <a href="/user/{{ user_id }}" title="Cancel"><button type="button" class="modalNVButton red">Cancel</button></a>
                    </td>
                    <td style="text-align: center;">
                        <span class="step"></span>
                        <span class="step"></span>
                        <span class="step"></span>
                        <span class="step"></span>
                    </td>
                    <td style="text-align: right">
                        <button type="button" id="prevBtn" class="modalNVButton" onclick="nextPrev(-1)">Previous</button>
                        <button type="button" id="nextBtn" class="modalNVButton green" onclick="nextPrev(1)">Next</button>
                    </td>
                </tr>
            </table>
        </div>
    </form>
</div>

   
<script type="text/javascript">
    let currentTab = 0;
    showTab(currentTab);

    function showEditUserDialog() {
        window.location = '{{ request.url.split("?")[0] }}#userModal';
    }

    function showTab(n) {
        const tabs = document.getElementsByClassName('tab');
        for (let i = 0; i < tabs.length; i++) {
            tabs[i].style.display = 'none';
        }
        tabs[n].style.display = 'block';

        if (n === 0) {
            document.getElementById('prevBtn').style.display = 'none';
        } else {
            document.getElementById('prevBtn').style.display = 'inline';
        }

        if (n === tabs.length - 1) {
            document.getElementById('nextBtn').innerHTML = 'Save';
        } else {
            document.getElementById('nextBtn').innerHTML = 'Next';
        }
    }

    function nextPrev(n) {
        const tabs = document.getElementsByClassName('tab');
        if (n === 1 && !validateForm()) return false;
        tabs[currentTab].style.display = 'none';
        currentTab = currentTab + n;

        if (currentTab >= tabs.length) {
            document.getElementById('editUserForm').submit();
            return false;
        }

        showTab(currentTab);
    }

    function validateForm() {
       
        return true;
    }
</script>
{% endblock %}





